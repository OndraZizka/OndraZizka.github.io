<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>XULRunner tutorial - Ondřej Žižka</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="My personal web">
    <meta name="author" content="Ondřej Žižka">
    <meta name="generator" content="JBake">


    <link rel="stylesheet" href="../../../css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../css/asciidoctor.css">
    <link rel="stylesheet" href="../../../css/base.css">
    <link rel="stylesheet" href="../../../css/doc-body.css">
    <link rel="stylesheet" href="../../../css/prettify.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../../favicon.ico">
</head>
<body onload="prettyPrint()">
    <div id="wrap">

	<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.zizka.ch/">Ondřej Žižka</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../../../index.html">Blog</a></li>
            <li><a href="../../../archive.html">Archive</a></li>
            <li><a href="../../../tags">Tags</a></li>

            <li><a href="../../../about.html">About Me</a></li>
            <li><a href="../../../feed.xml">RSS feed</a></li>
            <li><a href="../../../sitemap.xml">Sitemap</a></li>
            <!--
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
            -->
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">

	<div class="page-header">
        <h1>XULRunner tutorial - Ondřej Žižka</h1>
	</div>

	<div class="date"><em>2012-12-31</em></div>

	<div class="doc-body"><h3>XULRunner tutorial</h3> 
<p>I've been playing recently with a time-keeping tool, written in XUL, open in a popup window. The application is pretty simple, just allowing me to enter a list of tasks, and keep track of how long I've had any task selected. Being in a popup allows me to quickly change tasks and keep a much more accurate log of my&nbsp;time.</p> 
<p>I&nbsp;was having a problem though, because clicking links from emails or IMs would open up into my popup window, and not a new tab in Firefox, making me lose my data. <a title="Nathan's blog" href="http://blogs.acceleration.net/birdman/">Nathan</a> suggested <a href="http://wiki.mozilla.org/XUL:Xul_Runner">XULRunner</a>, and after losing my data 3&nbsp;more times, I&nbsp;broke down and figured out how to set it up. XULRunner is a command-line app to run XUL applications, essentially starting another gecko instance and running your code in that. That way Outlook won't think that's&nbsp;a good place to load windows, and if Firefox crashes, my XULRunner instance is still fine and&nbsp;dandy.</p> 
<p>Documentation on XULRunner is a bit <a href="http://developer-test.mozilla.org/docs/XULRunner">scant</a>, but googling revealed a <a href="http://friedfish.homeip.net/~darinf/xulrunner/xulmine.html">xulmine sample</a>, and from that I&nbsp;was able to reverse engineer what the hell XULRunner wanted me to do. And, now that I&nbsp;review some of these links, I&nbsp;see <a href="http://weblogs.mozillazine.org/darin/">Darin</a> has more information about XULRunner than I&nbsp;thought.</p> 
<p>As a convention, <em>emphasized</em> words are variables, and should be replaced with a value that makes sense for your application.</p> 
<h4>Setting up your folder structure</h4> 
<p>Set up your application like so:</p> 
<pre class="brush: plain"><code>/applicationName
   /chrome
      /applicationName
         your app files
      chrome.manifest
   /defaults
      /preferences
         prefs.js
   application.ini</code></pre> 
<pre class="brush: bash"><code>appName=myXulApp
mkdir -p $appName/chrome/$appName
   touch $appName/chrome/chrome.manifest
mkdir -p $appName/defaults/preferences
   touch $appName/defaults/preferences/prefs.js
   touch $appName/application.ini</code></pre> 
<p>There are more complicated ways to do it, but this seems to be the bare bones. Now let's&nbsp;set up all the configuration&nbsp;fi­les.</p> 
<h4>Setting up your <code>application.ini</code></h4> 
<p>XULRunner works by reading an <code>application.ini</code> file, and then loading things up by looking at specific directories. Here's&nbsp;a sample <code>application.ini</code>:</p> 
<pre class="brush: plain"><code>[App]
Vendor=company
Name=applicationName
Version=0.1
BuildID=20050506

[Gecko]
MinVersion=1.8
MaxVersion=1.8</code></pre> 
<p>The important bit is the <code>[Gecko]</code> section. The <code>[App]</code> section is nice, but doesn't seem to serve any essential function. The <code>[Gecko]</code> part tells XULRunner what versions of Gecko can be used with your app, and XULRunner will fail if those lines aren't&nbsp;there.</p> 
<h4>Setting up your <code>prefs.js</code></h4> 
<p>This is a preferences file, where you set initial values of things, either gecko engine settings or application specific settings. All we need here&nbsp;is:</p> 
<pre class="brush: plain"><code>pref("toolkit.defaultChromeURI", "chrome://&lt;em&gt;applicationName&lt;/em&gt;/content/&lt;em&gt;startPage&lt;/em&gt;.xul");</code></pre> 
<p>The <em>startPage</em> is what XUL page you want to view initially.</p> 
<h4>Setting up your <code>chrome.manifest</code></h4> 
<p>This file performs the mapping between a chrome:// url and your application&nbsp;files:</p> 
<pre class="brush: plain"><code>content &lt;em&gt;applicationName&lt;/em&gt; file:&lt;em&gt;applicationName&lt;/em&gt;/</code></pre> 
<p>That effectively tells XULRunner to look at <em>applicationName</em>/ in the chrome directory when it encounters a <code>chrome://&lt;em&gt;applicationName&lt;/em&gt;/content/</code>&nbsp;URI.</p> 
<p>Most XUL apps I've seen are distributed as a .jar file, rather than a subfolder of chrome/ with all the files scattered about.<br> Having your application unpacked is much easier for development, but when you do want to deploy it as a&nbsp;jar:</p> 
<ol> 
 <li>Zip up your /chrome/<em>appli­cationName</em> folder, put the <em>applicationNa­me</em>.zip in the /chrome directory.</li> 
 <li>Rename <em>applicationNa­me</em>.zip to <em>applicationNa­me</em>.jar</li> 
 <li>Change the <code>chrome.manifest</code> to point to <em>applicationNa­me</em>.jar: <pre class="brush: plain"><code>content &lt;em&gt;applicationName&lt;/em&gt; jar:&lt;em&gt;applicationName&lt;/em&gt;.jar!/</code></pre> <p>The <code>jar:</code> protocol tells XULRunner that this is a jar file, the the <code>!</code> after the filename tells it to look inside the jar&nbsp;file.</p> </li> 
</ol> 
<h4>Running your app with XULRunner</h4> 
<p>Now all the prep work has been done, and your application is ready to be run. After you <a href="http://ftp.mozilla.org/pub/mozilla.org/xulrunner/nightly/latest-trunk/">download XULRunner</a>, this is just a matter of a command&nbsp;line:</p> 
<pre class="brush: plain"><code>xulrunner application.ini</code></pre> 
<p>Your <em>startPage</em>.xul should open up in a window, like any other desktop&nbsp;app.</p> 
<h4>Conclusion</h4> 
<p>To get a XUL app working with XUL Runner, you need 3&nbsp;config files in 3&nbsp;different formats. That's&nbsp;kinda messed up. To be fair, the <code>chrome.manifest</code> format is something used for Firefox extensions, so it makes sense to re-use that functionality, but needing to specify your start page in <code>prefs.js</code> seems arbitrary. There are some proposals for a different method of <a href="http://wiki.mozilla.org/XUL:XUL_Application_Packaging">XUL Application Packaging</a>, but that's&nbsp;about a week old right now, and there's&nbsp;no code to support&nbsp;it.</p> 
<p>A&nbsp;XULRunner-based app seems like a good solution when you want to avoid Firefox. I&nbsp;want to avoid Firefox because of outlook, but in general I&nbsp;don't see much of an advantage over just making an extension, its just a series of trade offs.<br> </p> 
<h5>Pros:</h5> 
<ul> 
 <li>Runs in its own process</li> 
 <li>Unaffected by other Firefox extensions, skins, configuration.</li> 
 <li>Doesn't require Firefox</li> 
</ul> 
<h5>Cons:</h5> 
<ul> 
 <li>Doesn't auto-update with Firefox, auto-update code would need to be written</li> 
 <li>Unaffected by other Firefox extensions, skins, configuration.</li> 
 <li>Install package would be larger download to include the XULRunner binaries (13MB&nbsp;more)</li> 
</ul> 
<p>The big internal app we're writing will likely remain as a Firefox extension, but going through this process has certainly taught me a lot more about how to organize XUL apps. I&nbsp;wonder if you could munge XULRunner config files to point to a Firefox extension? Then you could auto-update with Firefox, and still get the benefits of XULRunner.</p> 
<p>Friday, May 06, 2005 3:29 PM</p></div>

	<hr />


    <!-- Facebook comments -->
        <div class="fb-comments" data-href="http://www.zizka.ch/pages/programovani/xul/xulrunner-tutorial.html" data-width="800" data-numposts="5"></div>

    </div>
    <div id="push"></div>

</div>

<div id="footer">
    <div class="container">
        <p class="muted credit">&copy; 2018 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.3.7</a> | Baked with <a href="http://jbake.org">JBake v2.7.0-SNAPSHOT</a></p>
    </div>
</div>

<script src="../../../js/jquery-1.11.1.min.js"></script>
<script src="../../../js/bootstrap.min.js"></script>
<script src="../../../js/prettify.js"></script>

<!-- Facebook comments -->
<div id="fb-root"></div>
<script>
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = 'https://connect.facebook.net/cs_CZ/sdk.js#xfbml=1&version=v3.0';
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-4584951-4"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-4584951-4');
</script>

</body>
</html>
